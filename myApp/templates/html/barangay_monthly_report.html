{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>

    <!-- Favicons -->
    <link href="{% static 'website/img/favicon.ico' %}" rel="icon">
    <link href="{% static 'website/img/apple-touch-icon.ico' %}" rel="apple-touch-icon">

    <!-- Bootstrap core CSS -->
    <link href="{% static 'website/lib/bootstrap/css/bootstrap.min.css' %}" rel="stylesheet">
    <!--external css-->
    <link href="{% static 'website/lib/font-awesome/css/font-awesome.css' %}" rel="stylesheet" />
    <link rel="stylesheet" type="text/css" href="{% static '/website/css/zabuto_calendar.css' %}">
    <link rel="stylesheet" type="text/css" href="{% static '/website/lib/gritter/css/jquery.gritter.css' %}" />
    <!-- Custom styles for this template -->
    <link href="{% static 'website/css/styles.css' %}" rel="stylesheet">
    <link href="{% static 'custom.css' %}" rel="stylesheet">
    
    
    <link href="{% static '/website/css/font.css' %}" rel="stylesheet">
    <link href="{% static 'website/css/style-responsive.css' %}" rel="stylesheet">
    <link rel="stylesheet" href="{% static 'website/lib/bootstrap/css/bootstrap.min.css' %}">
    <link rel="stylesheet" href="{% static 'website/lib/DataTables/css/mdb.min.css' %}">
    <link rel="stylesheet" href="{% static 'website/lib/bootstrap/css/ModifiedBootstrap.css' %}">
    <link rel="stylesheet" href="{% static 'website/lib/DataTables/css/dataTables.bootstrap4.min.css' %}">
    <script src="{% static 'website/lib/jquery/jquery.min.js' %}"></script>
    <script src="{% static 'website/lib/DataTables/js/popper.min.js' %}"></script>
    <script src="{% static 'website/lib/bootstrap/js/bootstrap.min.js' %}"></script>
    <script src="{% static 'website/lib/DataTables/js/mdb.min.js' %}"></script>
    <script src="{% static 'website/lib/chart.js' %}"></script>
    <script src="{% static 'UtilPage/utility.js' %}"></script>


</head>
<body onload="show(usertype) ; collection_rate()" >
<script>
    var usertype = "{{ context.UserType }}";
</script>
  <section id="container">

    <!--Header Start-->
    <header class="header black-bg">
        <div class="sidebar-toggle-box">
            <div class="fa fa-bars tooltips" data-placement="right" data-original-title="Toggle Navigation"></div>
        </div>
        <!--logo start-->
        <a href="" class="logo"><b>Ginatilan Water Billing<span> Station</span></b></a>
        <!--logo end-->

        <div class="top-menu">
            <ul class="nav pull-right top-menu">
                <li><a class="logout" href="/logout">Logout</a></li>
            </ul>
        </div>

    </header>
    <!--Header End-->
    <!--sidebar start-->
    <aside>
      <div id="sidebar" class="nav-collapse ">
          <!-- sidebar menu start-->
          <ul class="sidebar-menu" id="nav-accordion">
              <p class="centered"><a href=""><img src="{% static 'website/img/ui-admin.jpg' %}" class="img-circle" width="80"></a></p>
              <h5 class="centered">{{ context.name }}</h5>
              
              <div id="billspayment" >
                <li class="sub-menu" >
                  <a href="">
                    <i class="fa fa-money" aria-hidden="true"></i>
                      <span>Billing</span>
                  </a>
                  <ul class="sub">
                    <li><a href="/source_access/Payment">Bills Payment</a></li>                      
                    <li id=""><a href="/source_access/Send-Bill">Send Bill</a></li>
                    <li id=""><a href="/source_access/search-payment-history">Payment History</a></li>
                  </ul>
              </li>
            </div>

            <div id="input_reading" >
                  <li class="sub-menu" >
                    <a href="">
                      <i class="fa fa-calculator" aria-hidden="true"></i>
                        <span>Meter Reading</span>
                    </a>
                    <ul class="sub">
                      <li><a href="/source_access/add-meter-reading">Input Meter Reading</a></li>
                      <li id="modification"><a href="/source_access/Modify_Reading_Request">Modify Meter Reading</a></li>
                    </ul>
                </li>
            </div>

              <div id="manage_account" >
                <li class="sub-menu" >
                    <a class="" href="">
                        <i class="fa fa-address-book"></i>
                        <span>Consumer Accounts</span>
                    </a>
                    <ul class="sub">
                        <li><a href="/source_access/view-consumer-list">View Consumer List</a></li>
                        <li><a href="/source_access/add-new-consumer">Consumer Creation</a></li>
                        <li><a href="/source_access/view-suspended-account">Reactivate Account</a></li>
                    </ul>
                </li>
                </div>



                <div id="reports" >

                 <li class="sub-menu" >
                    <a href="" class="active">
                      <i class="fa fa-bar-chart" aria-hidden="true"></i>
                        <span>Reports</span>
                    </a>
                    <ul class="sub">
                      <li><a href="/source_access/barangay-monthly-report-data">Barangay Report</a></li>
                      <li><a href="/source_access/usage-report-data">Usage Report</a></li>
                      <li><a href="/source_access/revenue-report-data">Revenue Report</a></li>
                      <li><a href="/source_access/pending_bills">Unsettled Bills</a></li>
                    </ul>
                </li>
                </div>

                <div id="application" >
                <li class="sub-menu" >
                    <a href="">
                      <i class="fa fa-thumbs-up" aria-hidden="true"></i>
                        <span>Approve Application</span>
                    </a>
                    <ul class="sub">
                      <li id="approve_app"><a href="/source_access/list-applicants">Application Request</a></li>
                      <li><a href="/source_access/view-approved-applicants">Approved Applicants</a></li>
                    </ul>
                </li>
                </div>

                <div id="usermanagement" >
                <li class="sub-menu" >
                    <a class= "" href="/source_access/view-system-user">
                      <i class="fa fa-users" aria-hidden="true"></i>
                      <span>Users Management</span>
                      </a>
                  </li>
                </div>

                <div id="usercreation" >
                  <li class="sub-menu" >
                      <a class= "" href="/source_access/add_new_authorized_personel">
                        <i class="fa fa-user-plus"></i>
                        <span>User Creation</span>
                        </a>
                    </li>
                  </div>

                <div id="rates"  >
                <li class="sub-menu" >
                    <a class= "" href="/source_access/update-revenue-code" class="active">
                      <i class="fa fa-book" aria-hidden="true"></i>
                      <span>Rates Management</span>
                      </a>
                </li>
                </div>

                <div  id="backupdatabase"  >
                <li class="sub-menu">
                    <!--Temporary disabled -->
                    <!--<a href="">
                      <i class="fa fa-database"></i>
                      <span>Backup Database</span>
                      </a> -->
                    <ul class="sub">
                      <li><a href="html/daily_data">Daily Data</a></li>
                      <li><a href="">Weekly Data</a></li>
                      <li><a href="">Monthly Data</a></li>
                      <li><a href="">Yearly Data</a></li>
                    </ul>
                </li>
            </div>

            <div id="account-settings" >
              <li class="sub-menu" >
                  <a class="" href="">
                      <i class="fa fa-cogs"></i>
                      <span>Account Settings</span>
                  </a>
                  <ul class="sub">
                      <li><a href="/source_access/My-Account={{context.userid}}">My Account</a></li>
                      <li><a href="/manual" target="_blank">View User Manual</a></li>
                      <li><a href="/logout">Log Out</a></li>
                  </ul>
              </li>
          </div>
  
        </div>

        
  </aside>
  

  <section id="main-content">
    <div class="container">
    <div class="card1" style="margin-right: -30px">
    <section class="wrapper">

    <form  action="/source_access/barangay-monthly-report-data" method="POST">
      <script src="https:cdnjs.cloudflare.com/ajax/libs/Chart.js/2.5.0/Chart.min.js"> </script>
      <script>
        function convertToArray(obj) {
        return Object.keys(obj).map(function(key) {
            return obj[key];
        });
      }
      </script>
      <br>
      <br>

      

      <section>

        {%csrf_token%}

        <br>
      <br>
      <center><h1>Water Usage Per Barangay</h1></center>
      <br>
        
      <div class = "row">
          <div class = "col-sm-offset-7 col-sm-5">
                <div class="form-group">
                    <label for="exampleInputBarangay">Select Year</label>
                    <select name="{{ ReqParams.year }}" class="form-control" onchange='this.form.submit();'>
                      <option value="{{defval}}" selected>{{defval}}</option>
                      {% for year in allyear %}
                      <option value="{{ year}}">{{year}}</option>
                      {%endfor%}
                    </select>
                  </div>
                  <noscript><input type="submit" value="Submit"></noscript>
          </div>
            <div class = "col-sm">
              <div class="form-group"></div>
            </div>
            <div class = "col-sm">
                <div class="form-group"></div>
            </div>
            </div>
    
      </section>
   
   <!-- BarangayMonthlyRecordTable -->
<br>
  <div class="container-fluid">
      <!-- Responsive-Table -->
      <script>
        function collection_rate(){
          total_paid = document.getElementsByClassName("total_paid")
          total_due = document.getElementsByClassName("total_due")
          rate = document.getElementsByClassName("rate")

          for (let index = 0; index < rate.length; index++) {
            int_total_due = parseInt(total_due[index].innerHTML)
            int_total_paid = parseInt(total_paid[index].innerHTML)
            temporary_rate = (int_total_paid / int_total_due)* 100
            if (temporary_rate!==temporary_rate){
              rate[index].innerHTML = "0.0%"
            }else{
              rate[index].innerHTML = temporary_rate.toFixed(2)+ "%"
            }

          }
        }

        
      </script>
    <center><strong>Barangay Yearly Records for Year {{defval}}</strong></center>
    <div id=" "class="table-responsive">
      <table id="tablePagination" class="table table-striped table-bordered" style="width:100%">
        <thead>
            <tr>
                <th class="centered" scope="col">Barangay</th>
                <th class="centered" scope="col">Total Usage(Cu.Meter)</th>
                <th class="centered" scope="col">Total Receivables</th>
                <th class="centered" scope="col">Total Collection</th>
                <th class="centered" scope="col">Collection Rate</th>
            </tr>
        </thead>
        <tbody>
          <tr>
            <td>
              <ul class="list-inline m-0">
                  <li class="list-inline-item">
                      <a href="/source_access/barangay-monthly-record-data=1/{{defval}}" >Anao</a>
                  </li>
              </ul>
            </td>
            <td class="centered">{{ anao_record.total_usage }}</td>
            <td class="total_due" style="text-align: right">{{ anao_record.total_due_ytd|floatformat:2 }}</td>
            <td class="total_paid" style="text-align: right" >{{ anao_record.total_paid_ytd|floatformat:2}}</td>
            <td class="rate centered"></td>
          </tr>
          <tr>
            <td>
              <ul class="list-inline m-0">
                  <li class="list-inline-item">
                      <a href="/source_access/barangay-monthly-record-data=2/{{defval}}" >Cagsing</a>
                  </li>
              </ul>
            </td>
            <td class="centered">{{ cagsing_record.total_usage }}</td>
            <td class="total_due" style="text-align: right">{{ cagsing_record.total_due_ytd|floatformat:2 }}</td>
            <td class="total_paid" style="text-align: right">{{ cagsing_record.total_paid_ytd|floatformat:2}}</td>
            <td class="rate centered">Percentage</td>
          </tr>
          <tr>
            <td>
              <ul class="list-inline m-0">
                  <li class="list-inline-item">
                      <a href="/source_access/barangay-monthly-record-data=3/{{defval}}" >Calabawan</a>
                  </li>
              </ul>
            </td>
            <td class="centered">{{ calabawan_record.total_usage }}</td>
            <td class="total_due" style="text-align: right">{{ calabawan_record.total_due_ytd|floatformat:2 }}</td>
            <td class="total_paid" style="text-align: right">{{ calabawan_record.total_paid_ytd|floatformat:2}}</td>
            <td class="rate centered">Percentage</td>
          </tr>
          <tr>
            <td>
              <ul class="list-inline m-0">
                  <li class="list-inline-item">
                      <a href="/source_access/barangay-monthly-record-data=4/{{defval}}" >Cambagte</a>
                  </li>
              </ul>
            </td>
            <td class="centered">{{ cambagte_record.total_usage }}</td>
            <td class="total_due" style="text-align: right">{{ cambagte_record.total_due_ytd|floatformat:2 }}</td>
            <td class="total_paid" style="text-align: right">{{ cambagte_record.total_paid_ytd|floatformat:2}}</td>
            <td class="rate centered">Percentage</td>
          </tr>
          <tr>
            <td>
              <ul class="list-inline m-0">
                  <li class="list-inline-item">
                      <a href="/source_access/barangay-monthly-record-data=5/{{defval}}" >Campisong</a>
                  </li>
              </ul>
            </td>
            <td class="centered">{{ campisong_record.total_usage }}</td>
            <td class="total_due" style="text-align: right">{{ campisong_record.total_due_ytd|floatformat:2 }}</td>
            <td class="total_paid" style="text-align: right">{{ campisong_record.total_paid_ytd|floatformat:2}}</td>
            <td class="rate centered">Percentage</td>
          </tr>
          <tr>
            <td>
              <ul class="list-inline m-0">
                  <li class="list-inline-item">
                      <a href="/source_access/barangay-monthly-record-data=6/{{defval}}" >Cañorong</a>
                  </li>
              </ul>
            </td>
            <td class="centered">{{ cañorong_record.total_usage }}</td>
            <td class="total_due" style="text-align: right">{{ cañorong_record.total_due_ytd|floatformat:2 }}</td>
            <td class="total_paid" style="text-align: right">{{ cañorong_record.total_paid_ytd|floatformat:2}}</td>
            <td class="rate centered">Percentage</td>
          </tr>
          <tr>
            <td>
              <ul class="list-inline m-0">
                  <li class="list-inline-item">
                      <a href="/source_access/barangay-monthly-record-data=7/{{defval}}" >Guiwanon</a>
                  </li>
              </ul>
            </td>
            <td class="centered">{{ guiwanon_record.total_usage }}</td>
            <td class="total_due" style="text-align: right">{{ guiwanon_record.total_due_ytd|floatformat:2 }}</td>
            <td class="total_paid" style="text-align: right">{{ guiwanon_record.total_paid_ytd|floatformat:2}}</td>
            <td class="rate centered">Percentage</td>
          </tr>
          <tr>
            <td>
              <ul class="list-inline m-0">
                  <li class="list-inline-item">
                      <a href="/source_access/barangay-monthly-record-data=8/{{defval}}" >Looc</a>
                  </li>
              </ul>
            </td>
            <td class="centered">{{ looc_record.total_usage }}</td>
            <td class="total_due" style="text-align: right">{{ looc_record.total_due_ytd|floatformat:2 }}</td>
            <td class="total_paid" style="text-align: right">{{ looc_record.total_paid_ytd|floatformat:2}}</td>
            <td class="rate centered">Percentage</td>
          </tr>
          <tr>
            <td>
              <ul class="list-inline m-0">
                  <li class="list-inline-item">
                      <a href="/source_access/barangay-monthly-record-data=9/{{defval}}" >Malatbo</a>
                  </li>
              </ul>
            </td>
            <td class="centered">{{ malatbo_record.total_usage }}</td>
            <td class="total_due" style="text-align: right">{{ malatbo_record.total_due_ytd|floatformat:2 }}</td>
            <td class="total_paid" style="text-align: right">{{ malatbo_record.total_paid_ytd|floatformat:2}}</td>
            <td class="rate centered">Percentage</td>
          </tr>
          <tr>
            <td>
              <ul class="list-inline m-0">
                  <li class="list-inline-item">
                      <a href="/source_access/barangay-monthly-record-data=10/{{defval}}" >Mangaco</a>
                  </li>
              </ul>
            </td>
            <td class="centered">{{ mangaco_record.total_usage }}</td>
            <td class="total_due" style="text-align: right">{{ mangaco_record.total_due_ytd|floatformat:2 }}</td>
            <td class="total_paid" style="text-align: right">{{ mangaco_record.total_paid_ytd|floatformat:2}}</td>
            <td class="rate centered">Percentage</td>
          </tr>
          <tr>
            <td>
              <ul class="list-inline m-0">
                  <li class="list-inline-item">
                      <a href="/source_access/barangay-monthly-record-data=11/{{defval}}" >Palanas</a>
                  </li>
              </ul>
            </td>
            <td class="centered">{{ palanas_record.total_usage }}</td>
            <td class="total_due" style="text-align: right">{{ palanas_record.total_due_ytd|floatformat:2 }}</td>
            <td class="total_paid" style="text-align: right">{{ palanas_record.total_paid_ytd|floatformat:2}}</td>
            <td class="rate centered">Percentage</td>
          </tr>
          <tr>
            <td>
              <ul class="list-inline m-0">
                  <li class="list-inline-item">
                      <a href="/source_access/barangay-monthly-record-data=12/{{defval}}" >Poblacion</a>
                  </li>
              </ul>
            </td>
            <td class="centered">{{ poblacion_record.total_usage }}</td>
            <td class="total_due" style="text-align: right">{{ poblacion_record.total_due_ytd|floatformat:2 }}</td>
            <td class="total_paid" style="text-align: right">{{ poblacion_record.total_paid_ytd|floatformat:2}}</td>
            <td class="rate centered">Percentage</td>
          </tr>
          <tr>
            <td>
              <ul class="list-inline m-0">
                  <li class="list-inline-item">
                      <a href="/source_access/barangay-monthly-record-data=13/{{defval}}" >Salamanca</a>
                  </li>
              </ul>
            </td>
            <td class="centered">{{ salamanca_record.total_usage }}</td>
            <td class="total_due" style="text-align: right">{{ salamanca_record.total_due_ytd|floatformat:2 }}</td>
            <td class="total_paid" style="text-align: right">{{ salamanca_record.total_paid_ytd|floatformat:2}}</td>
            <td class="rate centered">Percentage</td>
          </tr>
          <tr>
            <td>
              <ul class="list-inline m-0">
                  <li class="list-inline-item">
                      <a href="/source_access/barangay-monthly-record-data=14/{{defval}}" >San Roque</a>
                  </li>
              </ul>
            </td>
            <td class="centered">{{ sanroque_record.total_usage }}</td>
            <td class="total_due" style="text-align: right">{{ sanroque_record.total_due_ytd|floatformat:2 }}</td>
            <td class="total_paid" style="text-align: right">{{ sanroque_record.total_paid_ytd|floatformat:2}}</td>
            <td class="rate centered">Percentage</td>
          </tr>
          <tr>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
          </tr>
          <tr>
            <td> Total</td>
            <td class="usage centered">{{report.total_usage}}</td>
            <td class="total_due" style="text-align: right">{{report.total_due_ytd}}</td>
            <td class="total_paid" style="text-align: right">{{report.total_paid_ytd}}</td>
            <td class="rate centered"></td>
          </tr>

        </tbody>
      </div>
  </div>

</section>


  <br>
  <br>

<p id="show"></p>
</form>
</div>
</div>
</section>

</section>
</section>

<div class="se-pre-con"></div>
                  <script>
                    function load(){
                      document.getElementsByClassName("se-pre-con").style.display = "block"
                    }
                  </script>
 <!-- js placed at the end of the document so the pages load faster -->
 <script src="{% static 'website/lib/jquery/jquery.min.js' %}"></script>

 <script src="{% static 'website/lib/bootstrap/js/bootstrap.min.js' %}"></script>
 <script class="include" type="text/javascript" src="{% static 'website/lib/jquery.dcjqaccordion.2.7.js' %} "></script>
 <script src="{% static 'website/lib/jquery.scrollTo.min.js' %}"></script>
 <script src="{% static 'website/lib/jquery.nicescroll.js' %}" type="text/javascript"></script>
 <script src="{% static 'website/lib/jquery.sparkline.js' %}"></script>
 <script src="{% static 'website/lib/common-scripts.js' %}"></script>
 <script type="text/javascript" src="{% static 'website/lib/gritter/js/jquery.gritter.js' %}"></script>
 <script type="text/javascript" src="{% static 'website/lib/gritter-conf.js' %}"></script>

 <script>
  $(document).ready(function() {
      $('#tablePagination').DataTable();
  } );


   $(window).on("load",function(){
       $(".loader-wrapper").fadeOut("milliseconds");
  });


  $(window).on("load",function() {
  // Animate loader off screen
  $(".se-pre-con").fadeOut("slow");;
  });
  </script>
</body>
</html>
